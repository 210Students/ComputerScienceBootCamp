>"컴퓨터 사이언스 부트캠프 with 파이썬"을 보고 정리했습니다.
>
>개인공부 후 자료를 남기기 위한 목적이므로 내용 상에 오류가 있을 수 있습니다.

# 4장 문자와 문자열

### 아스키코드

 숫자로 문자를 표현하기 위해 미국에서 제정한 규칙이다. 아스키는 8비트 중 7비트를 이용하여 총 128개의 문자를 표현하고 1비트는 패리트 비트라 하여 **통신 에러 검출** 목적으로 사용한다. 

| 7 비트 데이터 | 패리티 포함 8 비트 |              |
| ------------- | ------------------ | ------------ |
|               | 짝수               | 홀수         |
| 0000000 (0)   | **0**0000000       | **1**0000000 |
| 1010001 (3)   | **1**1010001       | **0**1010001 |
| 1101001 (4)   | **0**1101001       | **1**1101001 |
| 1111111 (7)   | **1**1111111       | **0**1111111 |

<br>

**용어 정리**

- 문자 집합: 표현해야할 문자와 순서를 지정하여 모아둔 것
- 문자 인코딩: 문자 집합을 메모리에 저장하거나 통신을 위해 컴퓨터가 알 수 있는 0, 1로 바꾸는 것
- 코드 포인트: 문자 'A'에 숫자 65를 매핑시키면 65라는 정수는 특정 문자를 표현하고 이 매핑된 정수를 '코드포인트'라고 한다.
- 부호화된 문자 집합: 코드 포인트의 집합

<br>

![더북](https://thebook.io/img/006950/046_1.jpg)

왼쪽 4개 열 Decimal, Hexadecimal, Binary, Octal 은 코드 포인트를 진수별로 변환한 것이고 마지막 열은 해당 코드 포인트에 매핑된 문자이다.

<br>

```python
>>> ch = 'A'
>>> bch = ch.encode()
>>> bch
b'A'
>>> bch[0]
65
```

대문자 'A'가 정수 65와 매핑됐다는 것을 확인할 수 있다.

 정수 표현을 위해 int형(4바이트), short형(2바이트)을 사용할 수 있다. 1바이트로 정수를 표현할 수 있는 작은 수 (-128 ~ 127)라면, 문자를 담기 위해 만들어진 char형으로도 정수 표현이 가능하다.

<br>

### 유니코드

 미국에서 발전한 컴퓨터가 전 세계적으로 보급되고 인터넷을 통해 세계 각국 사람들이 커뮤니케이션을 하게 되면서 표현해야 할 언어가 많아졌다. 이를 해결하고자 나온 방법이 7비트에서 16비트로 확장하는 것이다. 이렇게 확장하면 65,536개의 문자를 표현할 수 있게 된다. 기존의 아스키코드를 유지하고 숫자 하나씩 더해 문자와 매핑시킨 표를 만들었는데, 이 테이블이 유니코드다. 

<br>

 문자 표현에 2바이트면 충분할 거 같지만 모르는 일이다. 그래서 언어 대부분이 포함된 첫 번째 테이블을 기본 다국어 평면이라 하고, 이와 비슷한 테이블을 총 열일곱 개를 준비했다. 

<br>

한글은 [U+AC00 ~ U+D7AF](http://titus.uni-frankfurt.de/unicode/unitestx.htm)까지 위치하고 있습니다.

<br>

### 유니코드 인코딩 방식

**용어 정리**

- 코드 포인트: 특정 문자에 매핑된 정수
- 코드 유닛: 코드 포인트를 특정 방법으로 인코딩했을 경우 변환되어 얻어지는 비트의 나열
- 옥텟: 데이터 단위로 8비트를 의미
- 문자 인코딩 방식: 코드 유닛을 옥텟으로 나열하여 변환하는 방법

<br>

유니코드는 2바이트 숫자 하나와 문자 하나를 매핑하여 문자를 표현한다. 기본 다국어 평면을 포함해 평면이 열일곱 개 있으므로 모든 문자를 표현하려면 3바이트가 필요하다. 그러면 코드 유닛의 크기를 3바이트로 하고 이대로 저장하면 되지 않을까 싶지만 쉽지 않다. 만약 1바이트 정수만 저장하 수 있는 시스템이라면 2바이트 3바이트는 저장할 수가 없게 된다. 그러므로 다양한 코드 유닛을 갖는 인코딩 방식을 두어 유연하게 대처해야 한다. 여기서는 UTF-8, UTF-16, UTF-32를 다루겠다.

<br>

### UTF-8

유니코드 문자 하나를 1~4바이트 사이에서 표현한다. 문자에 따라 바이트 수가 달라지므로 **가변 길이의 인코딩 방식**이라 부른다.

| 코드 범위([십육진법](https://ko.wikipedia.org/wiki/%EC%8B%AD%EC%9C%A1%EC%A7%84%EB%B2%95)) | 바이트 | UTF-8 표현([이진법](https://ko.wikipedia.org/wiki/%EC%9D%B4%EC%A7%84%EB%B2%95)) |
| ------------------------------------------------------------ | ------ | ------------------------------------------------------------ |
| `000000-00007F`                                              | 1      | `0xxxxxxx`                                                   |
| `000080-0007FF`                                              | 2      | `110xxxxx 10xxxxxx`                                          |
| `000800-00FFFF`                                              | 3      | `1110xxxx 10xxxxxx 10xxxxxx`                                 |
| `010000-10FFFF`                                              | 4      | `11110zzz 10zzxxxx 10xxxxxx 10xxxxxx`                        |

```
char * str1 = u8"가";
```

- 유니코드인데도 1바이트인 char형에 담는다는 것을 주목해야 한다
- *str1 메모리 공간을 가리킨다

- u8은 UTF-8을 의미한다

![더북](https://thebook.io/img/006950/052_1.jpg)

'가' 문자가 저장된 메모리 주소를 보면 3바이트로 표현되어 있다는 것을 볼 수 있습니다. 3바이트인 이유는 코드 포인트 '가'의 코드 포인트 U+AC00은 000800-00FFFF 사이에 있기 때문입니다. 3바이트이기에 포맷은   `1110xxxx 10xxxxxx 10xxxxxx` 로 변환됩니다. x 부분에는 '가' 코드 포인트 U+AC00를 2진수로 변환 후, 차례대로 채워 넣습니다.

'가' 코드 포인트 U+AC00를 2진수로 변환하면 다음과 같습니다.

![더북](https://thebook.io/img/006950/053.jpg)

위 2 진수를 차례대로 포맷에 넣으면 아래와 같습니다.

![더북](https://thebook.io/img/006950/053_3.jpg)

그리고 16진수로 변환하면 0xEAB080 됩니다.

<br>

### UTF-16

해당 문자가 기본 다국어 평면에 있으면 2바이트로 인코딩되고, 그렇지 않으면 4바이트로 인코딩됩니다. 코드 유닛의 크기는 16비트이다.

```
char16_t * str2 = u"가";
```

![더북](https://thebook.io/img/006950/054_1.jpg)

<br>

### UTF-32

모든 문자를 4바이트로 표현된다. 그러므로 기본 다국어 평면의 문자뿐만 아니라 모든 평면에 있는 문자를 한 개 단위로 담을 수 있다.

```
char32_t * str3 = U"가";
```

![더북](https://thebook.io/img/006950/054_2.jpg)

<br>

### 파이썬 문자열의 특징

C/C++에서는 문자열을 변수로 만들면 요소인 문자를 변경할 수 있고, 문자열을 상수로 만들면 요소를 변경할 수 없다. 즉 프로그래머가 변경 가능성을 선택할 수 있다. 그러나 파이썬에서는 문자열을 변경할 수 없다.

```python
>>> string = 'abcde'
>>> string[2] = 'a'
Traceback (most recent call last):
    File "<pyshell#3>", line 1, in <module>
       string[2] = 'a'
TypeError: 'str' object does not support item assignment
```

<br>

그렇다면 파이썬에서는 문자열 중간에 요소를 바꾸고 싶다면 어떻게 하면 될까?

- 문자열 슬라이싱

  ```python
  >>> new_string = string[:2] + 'x' + string[3:]
  >>> new_string
  'abxde'
  ```

- 내장함수 replace()

  ```python
  >>> string = 'abcde'
  >>> new_string = string.replace('c', 'x')
  >>> new_string
  'abxde'
  >>> string
  'abcde'
  ```

두 가지 방법 모두 string의 요소를 직접 변경하지 않았다.